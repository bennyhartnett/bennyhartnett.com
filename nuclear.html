<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Uranium Enrichment Calculators</title>

  <!-- Tailwind via CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          colors: {
            nuclear: {
              50: '#f0fdf4',
              100: '#dcfce7',
              200: '#bbf7d0',
              300: '#86efac',
              400: '#4ade80',
              500: '#22c55e',
              600: '#16a34a',
              700: '#15803d',
              800: '#166534',
              900: '#14532d',
            }
          }
        }
      }
    }
  </script>

  <!-- SweetAlert2 for error messages -->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
    body { font-family: 'Inter', sans-serif; }

    /* Custom scrollbar */
    ::-webkit-scrollbar { width: 8px; }
    ::-webkit-scrollbar-track { background: #1e293b; }
    ::-webkit-scrollbar-thumb { background: #475569; border-radius: 4px; }
    ::-webkit-scrollbar-thumb:hover { background: #64748b; }

    /* Smooth transitions */
    details[open] summary ~ * { animation: fadeIn 0.2s ease-out; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(-4px); } to { opacity: 1; transform: translateY(0); } }

    /* Active tab indicator */
    .tab-active { border-bottom: 2px solid #22c55e; color: #22c55e; }
  </style>
</head>
<body class="min-h-screen bg-slate-900 text-slate-100">

  <!-- Top bar -->
  <header class="fixed top-0 left-0 right-0 z-50 bg-slate-900/95 backdrop-blur border-b border-slate-800">
    <div class="max-w-5xl mx-auto px-4 h-14 flex items-center justify-between">
      <a href="/" class="flex items-center gap-2 text-slate-400 hover:text-white transition-colors">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"/>
        </svg>
        <span class="text-sm font-medium">Back</span>
      </a>
      <h1 class="text-sm font-semibold text-slate-300">Uranium Enrichment Calculators</h1>
      <div class="w-16"></div>
    </div>
  </header>

  <main class="pt-20 pb-16 px-4">
    <div class="max-w-3xl mx-auto">

      <!-- Hero section -->
      <div class="text-center mb-10">
        <div class="inline-flex items-center justify-center w-16 h-16 rounded-full bg-nuclear-500/10 mb-4">
          <svg class="w-8 h-8 text-nuclear-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"/>
          </svg>
        </div>
        <h2 class="text-2xl font-bold text-white mb-2">SWU Calculator Suite</h2>
        <p class="text-slate-400 text-sm max-w-lg mx-auto">
          Browser-based tools for uranium enrichment calculations: feed requirements, SWU demand, and optimum tails assay.
        </p>
      </div>

      <!-- Calculator tabs -->
      <nav class="flex gap-1 overflow-x-auto pb-2 mb-6 border-b border-slate-800" id="calcTabs">
        <button data-target="mode1" class="tab-active px-3 py-2 text-xs font-medium whitespace-nowrap rounded-t hover:text-nuclear-400 transition-colors">
          Feed & SWU (1 kg)
        </button>
        <button data-target="mode2" class="px-3 py-2 text-xs font-medium whitespace-nowrap text-slate-500 rounded-t hover:text-nuclear-400 transition-colors">
          Feed & SWU from EUP
        </button>
        <button data-target="mode3" class="px-3 py-2 text-xs font-medium whitespace-nowrap text-slate-500 rounded-t hover:text-nuclear-400 transition-colors">
          EUP & SWU from Feed
        </button>
        <button data-target="mode4" class="px-3 py-2 text-xs font-medium whitespace-nowrap text-slate-500 rounded-t hover:text-nuclear-400 transition-colors">
          Feed & EUP from SWU
        </button>
        <button data-target="mode5" class="px-3 py-2 text-xs font-medium whitespace-nowrap text-slate-500 rounded-t hover:text-nuclear-400 transition-colors">
          Optimum Tails
        </button>
      </nav>

      <!-- Calculator 1: Feed & SWU for 1 kg U EUP -->
      <section id="mode1" class="calc-section">
        <div class="bg-slate-800/50 rounded-xl border border-slate-700/50 p-6">
          <div class="mb-6">
            <h3 class="text-lg font-semibold text-white mb-1">Feed & SWU for 1 kg U EUP</h3>
            <p class="text-slate-500 text-sm">Calculate feed and SWU requirements for 1 kilogram of enriched uranium product.</p>
          </div>

          <form id="form1" class="space-y-6">
            <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
              <div>
                <label for="xp1" class="block text-xs font-medium text-slate-400 mb-1.5">Product Assay</label>
                <div class="relative">
                  <input id="xp1" type="number" step="any" placeholder="5"
                    class="w-full bg-slate-900 border border-slate-700 rounded-lg px-3 py-2.5 text-sm text-white placeholder-slate-600 focus:border-nuclear-500 focus:ring-1 focus:ring-nuclear-500 outline-none transition" />
                  <span class="absolute right-3 top-1/2 -translate-y-1/2 text-xs text-slate-500">% U-235</span>
                </div>
              </div>
              <div>
                <label for="xw1" class="block text-xs font-medium text-slate-400 mb-1.5">Tails Assay</label>
                <div class="relative">
                  <input id="xw1" type="number" step="any" placeholder="0.3"
                    class="w-full bg-slate-900 border border-slate-700 rounded-lg px-3 py-2.5 text-sm text-white placeholder-slate-600 focus:border-nuclear-500 focus:ring-1 focus:ring-nuclear-500 outline-none transition" />
                  <span class="absolute right-3 top-1/2 -translate-y-1/2 text-xs text-slate-500">% U-235</span>
                </div>
              </div>
              <div>
                <label for="xf1" class="block text-xs font-medium text-slate-400 mb-1.5">Feed Assay</label>
                <div class="relative">
                  <input id="xf1" type="number" step="any" placeholder="0.711"
                    class="w-full bg-slate-900 border border-slate-700 rounded-lg px-3 py-2.5 text-sm text-white placeholder-slate-600 focus:border-nuclear-500 focus:ring-1 focus:ring-nuclear-500 outline-none transition" />
                  <span class="absolute right-3 top-1/2 -translate-y-1/2 text-xs text-slate-500">% U-235</span>
                </div>
              </div>
            </div>

            <div class="h-px bg-slate-700/50"></div>

            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
              <div>
                <label for="feed1" class="block text-xs font-medium text-slate-400 mb-1.5">Feed Quantity</label>
                <div class="relative">
                  <input id="feed1" type="text" readonly
                    class="w-full bg-slate-950 border border-slate-700 rounded-lg px-3 py-2.5 text-sm text-nuclear-400 font-mono outline-none" />
                  <span class="absolute right-3 top-1/2 -translate-y-1/2 text-xs text-slate-500">kg U</span>
                </div>
              </div>
              <div>
                <label for="swu1" class="block text-xs font-medium text-slate-400 mb-1.5">SWU Quantity</label>
                <div class="relative">
                  <input id="swu1" type="text" readonly
                    class="w-full bg-slate-950 border border-slate-700 rounded-lg px-3 py-2.5 text-sm text-nuclear-400 font-mono outline-none" />
                  <span class="absolute right-3 top-1/2 -translate-y-1/2 text-xs text-slate-500">SWU</span>
                </div>
              </div>
            </div>

            <div class="flex gap-3 pt-2">
              <button type="button" id="clear1"
                class="flex-1 py-2.5 px-4 text-sm font-medium text-slate-400 bg-slate-800 border border-slate-700 rounded-lg hover:bg-slate-700 hover:text-white transition">
                Clear
              </button>
              <button type="button" id="calc1"
                class="flex-1 py-2.5 px-4 text-sm font-medium text-white bg-nuclear-600 rounded-lg hover:bg-nuclear-500 transition">
                Calculate
              </button>
            </div>
          </form>
        </div>
      </section>

      <!-- Calculator 2: Feed & SWU from EUP Quantity -->
      <section id="mode2" class="calc-section hidden">
        <div class="bg-slate-800/50 rounded-xl border border-slate-700/50 p-6">
          <div class="mb-6">
            <h3 class="text-lg font-semibold text-white mb-1">Feed & SWU from EUP Quantity</h3>
            <p class="text-slate-500 text-sm">Calculate feed and SWU requirements for a given mass of enriched product.</p>
          </div>

          <form id="form2" class="space-y-6">
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
              <div>
                <label for="p2" class="block text-xs font-medium text-slate-400 mb-1.5">EUP Quantity</label>
                <div class="relative">
                  <input id="p2" type="number" step="any" placeholder="100"
                    class="w-full bg-slate-900 border border-slate-700 rounded-lg px-3 py-2.5 text-sm text-white placeholder-slate-600 focus:border-nuclear-500 focus:ring-1 focus:ring-nuclear-500 outline-none transition" />
                  <span class="absolute right-3 top-1/2 -translate-y-1/2 text-xs text-slate-500">kg U</span>
                </div>
              </div>
              <div>
                <label for="xp2" class="block text-xs font-medium text-slate-400 mb-1.5">Product Assay</label>
                <div class="relative">
                  <input id="xp2" type="number" step="any" placeholder="5"
                    class="w-full bg-slate-900 border border-slate-700 rounded-lg px-3 py-2.5 text-sm text-white placeholder-slate-600 focus:border-nuclear-500 focus:ring-1 focus:ring-nuclear-500 outline-none transition" />
                  <span class="absolute right-3 top-1/2 -translate-y-1/2 text-xs text-slate-500">% U-235</span>
                </div>
              </div>
              <div>
                <label for="xw2" class="block text-xs font-medium text-slate-400 mb-1.5">Tails Assay</label>
                <div class="relative">
                  <input id="xw2" type="number" step="any" placeholder="0.3"
                    class="w-full bg-slate-900 border border-slate-700 rounded-lg px-3 py-2.5 text-sm text-white placeholder-slate-600 focus:border-nuclear-500 focus:ring-1 focus:ring-nuclear-500 outline-none transition" />
                  <span class="absolute right-3 top-1/2 -translate-y-1/2 text-xs text-slate-500">% U-235</span>
                </div>
              </div>
              <div>
                <label for="xf2" class="block text-xs font-medium text-slate-400 mb-1.5">Feed Assay</label>
                <div class="relative">
                  <input id="xf2" type="number" step="any" placeholder="0.711"
                    class="w-full bg-slate-900 border border-slate-700 rounded-lg px-3 py-2.5 text-sm text-white placeholder-slate-600 focus:border-nuclear-500 focus:ring-1 focus:ring-nuclear-500 outline-none transition" />
                  <span class="absolute right-3 top-1/2 -translate-y-1/2 text-xs text-slate-500">% U-235</span>
                </div>
              </div>
            </div>

            <div class="h-px bg-slate-700/50"></div>

            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
              <div>
                <label for="feed2" class="block text-xs font-medium text-slate-400 mb-1.5">Feed Quantity</label>
                <div class="relative">
                  <input id="feed2" type="text" readonly
                    class="w-full bg-slate-950 border border-slate-700 rounded-lg px-3 py-2.5 text-sm text-nuclear-400 font-mono outline-none" />
                  <span class="absolute right-3 top-1/2 -translate-y-1/2 text-xs text-slate-500">kg U</span>
                </div>
              </div>
              <div>
                <label for="swu2" class="block text-xs font-medium text-slate-400 mb-1.5">SWU Quantity</label>
                <div class="relative">
                  <input id="swu2" type="text" readonly
                    class="w-full bg-slate-950 border border-slate-700 rounded-lg px-3 py-2.5 text-sm text-nuclear-400 font-mono outline-none" />
                  <span class="absolute right-3 top-1/2 -translate-y-1/2 text-xs text-slate-500">SWU</span>
                </div>
              </div>
            </div>

            <div class="flex gap-3 pt-2">
              <button type="button" id="clear2"
                class="flex-1 py-2.5 px-4 text-sm font-medium text-slate-400 bg-slate-800 border border-slate-700 rounded-lg hover:bg-slate-700 hover:text-white transition">
                Clear
              </button>
              <button type="button" id="calc2"
                class="flex-1 py-2.5 px-4 text-sm font-medium text-white bg-nuclear-600 rounded-lg hover:bg-nuclear-500 transition">
                Calculate
              </button>
            </div>
          </form>
        </div>
      </section>

      <!-- Calculator 3: EUP & SWU from Feed Quantity -->
      <section id="mode3" class="calc-section hidden">
        <div class="bg-slate-800/50 rounded-xl border border-slate-700/50 p-6">
          <div class="mb-6">
            <h3 class="text-lg font-semibold text-white mb-1">EUP & SWU from Feed Quantity</h3>
            <p class="text-slate-500 text-sm">Calculate enriched product and SWU from a given feed mass.</p>
          </div>

          <form id="form3" class="space-y-6">
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
              <div>
                <label for="F3" class="block text-xs font-medium text-slate-400 mb-1.5">Feed Quantity</label>
                <div class="relative">
                  <input id="F3" type="number" step="any" placeholder="100"
                    class="w-full bg-slate-900 border border-slate-700 rounded-lg px-3 py-2.5 text-sm text-white placeholder-slate-600 focus:border-nuclear-500 focus:ring-1 focus:ring-nuclear-500 outline-none transition" />
                  <span class="absolute right-3 top-1/2 -translate-y-1/2 text-xs text-slate-500">kg U</span>
                </div>
              </div>
              <div>
                <label for="xp3" class="block text-xs font-medium text-slate-400 mb-1.5">Product Assay</label>
                <div class="relative">
                  <input id="xp3" type="number" step="any" placeholder="5"
                    class="w-full bg-slate-900 border border-slate-700 rounded-lg px-3 py-2.5 text-sm text-white placeholder-slate-600 focus:border-nuclear-500 focus:ring-1 focus:ring-nuclear-500 outline-none transition" />
                  <span class="absolute right-3 top-1/2 -translate-y-1/2 text-xs text-slate-500">% U-235</span>
                </div>
              </div>
              <div>
                <label for="xw3" class="block text-xs font-medium text-slate-400 mb-1.5">Tails Assay</label>
                <div class="relative">
                  <input id="xw3" type="number" step="any" placeholder="0.3"
                    class="w-full bg-slate-900 border border-slate-700 rounded-lg px-3 py-2.5 text-sm text-white placeholder-slate-600 focus:border-nuclear-500 focus:ring-1 focus:ring-nuclear-500 outline-none transition" />
                  <span class="absolute right-3 top-1/2 -translate-y-1/2 text-xs text-slate-500">% U-235</span>
                </div>
              </div>
              <div>
                <label for="xf3" class="block text-xs font-medium text-slate-400 mb-1.5">Feed Assay</label>
                <div class="relative">
                  <input id="xf3" type="number" step="any" placeholder="0.711"
                    class="w-full bg-slate-900 border border-slate-700 rounded-lg px-3 py-2.5 text-sm text-white placeholder-slate-600 focus:border-nuclear-500 focus:ring-1 focus:ring-nuclear-500 outline-none transition" />
                  <span class="absolute right-3 top-1/2 -translate-y-1/2 text-xs text-slate-500">% U-235</span>
                </div>
              </div>
            </div>

            <div class="h-px bg-slate-700/50"></div>

            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
              <div>
                <label for="P3" class="block text-xs font-medium text-slate-400 mb-1.5">EUP Quantity</label>
                <div class="relative">
                  <input id="P3" type="text" readonly
                    class="w-full bg-slate-950 border border-slate-700 rounded-lg px-3 py-2.5 text-sm text-nuclear-400 font-mono outline-none" />
                  <span class="absolute right-3 top-1/2 -translate-y-1/2 text-xs text-slate-500">kg U</span>
                </div>
              </div>
              <div>
                <label for="swu3" class="block text-xs font-medium text-slate-400 mb-1.5">SWU Quantity</label>
                <div class="relative">
                  <input id="swu3" type="text" readonly
                    class="w-full bg-slate-950 border border-slate-700 rounded-lg px-3 py-2.5 text-sm text-nuclear-400 font-mono outline-none" />
                  <span class="absolute right-3 top-1/2 -translate-y-1/2 text-xs text-slate-500">SWU</span>
                </div>
              </div>
            </div>

            <div class="flex gap-3 pt-2">
              <button type="button" id="clear3"
                class="flex-1 py-2.5 px-4 text-sm font-medium text-slate-400 bg-slate-800 border border-slate-700 rounded-lg hover:bg-slate-700 hover:text-white transition">
                Clear
              </button>
              <button type="button" id="calc3"
                class="flex-1 py-2.5 px-4 text-sm font-medium text-white bg-nuclear-600 rounded-lg hover:bg-nuclear-500 transition">
                Calculate
              </button>
            </div>
          </form>
        </div>
      </section>

      <!-- Calculator 4: Feed & EUP from SWU Quantity -->
      <section id="mode4" class="calc-section hidden">
        <div class="bg-slate-800/50 rounded-xl border border-slate-700/50 p-6">
          <div class="mb-6">
            <h3 class="text-lg font-semibold text-white mb-1">Feed & EUP from SWU Quantity</h3>
            <p class="text-slate-500 text-sm">Calculate feed and product quantities from available SWU.</p>
          </div>

          <form id="form4" class="space-y-6">
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
              <div>
                <label for="S4" class="block text-xs font-medium text-slate-400 mb-1.5">SWU Quantity</label>
                <div class="relative">
                  <input id="S4" type="number" step="any" placeholder="500"
                    class="w-full bg-slate-900 border border-slate-700 rounded-lg px-3 py-2.5 text-sm text-white placeholder-slate-600 focus:border-nuclear-500 focus:ring-1 focus:ring-nuclear-500 outline-none transition" />
                  <span class="absolute right-3 top-1/2 -translate-y-1/2 text-xs text-slate-500">SWU</span>
                </div>
              </div>
              <div>
                <label for="xp4" class="block text-xs font-medium text-slate-400 mb-1.5">Product Assay</label>
                <div class="relative">
                  <input id="xp4" type="number" step="any" placeholder="5"
                    class="w-full bg-slate-900 border border-slate-700 rounded-lg px-3 py-2.5 text-sm text-white placeholder-slate-600 focus:border-nuclear-500 focus:ring-1 focus:ring-nuclear-500 outline-none transition" />
                  <span class="absolute right-3 top-1/2 -translate-y-1/2 text-xs text-slate-500">% U-235</span>
                </div>
              </div>
              <div>
                <label for="xw4" class="block text-xs font-medium text-slate-400 mb-1.5">Tails Assay</label>
                <div class="relative">
                  <input id="xw4" type="number" step="any" placeholder="0.3"
                    class="w-full bg-slate-900 border border-slate-700 rounded-lg px-3 py-2.5 text-sm text-white placeholder-slate-600 focus:border-nuclear-500 focus:ring-1 focus:ring-nuclear-500 outline-none transition" />
                  <span class="absolute right-3 top-1/2 -translate-y-1/2 text-xs text-slate-500">% U-235</span>
                </div>
              </div>
              <div>
                <label for="xf4" class="block text-xs font-medium text-slate-400 mb-1.5">Feed Assay</label>
                <div class="relative">
                  <input id="xf4" type="number" step="any" placeholder="0.711"
                    class="w-full bg-slate-900 border border-slate-700 rounded-lg px-3 py-2.5 text-sm text-white placeholder-slate-600 focus:border-nuclear-500 focus:ring-1 focus:ring-nuclear-500 outline-none transition" />
                  <span class="absolute right-3 top-1/2 -translate-y-1/2 text-xs text-slate-500">% U-235</span>
                </div>
              </div>
            </div>

            <div class="h-px bg-slate-700/50"></div>

            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
              <div>
                <label for="P4" class="block text-xs font-medium text-slate-400 mb-1.5">EUP Quantity</label>
                <div class="relative">
                  <input id="P4" type="text" readonly
                    class="w-full bg-slate-950 border border-slate-700 rounded-lg px-3 py-2.5 text-sm text-nuclear-400 font-mono outline-none" />
                  <span class="absolute right-3 top-1/2 -translate-y-1/2 text-xs text-slate-500">kg U</span>
                </div>
              </div>
              <div>
                <label for="feed4" class="block text-xs font-medium text-slate-400 mb-1.5">Feed Quantity</label>
                <div class="relative">
                  <input id="feed4" type="text" readonly
                    class="w-full bg-slate-950 border border-slate-700 rounded-lg px-3 py-2.5 text-sm text-nuclear-400 font-mono outline-none" />
                  <span class="absolute right-3 top-1/2 -translate-y-1/2 text-xs text-slate-500">kg U</span>
                </div>
              </div>
            </div>

            <div class="flex gap-3 pt-2">
              <button type="button" id="clear4"
                class="flex-1 py-2.5 px-4 text-sm font-medium text-slate-400 bg-slate-800 border border-slate-700 rounded-lg hover:bg-slate-700 hover:text-white transition">
                Clear
              </button>
              <button type="button" id="calc4"
                class="flex-1 py-2.5 px-4 text-sm font-medium text-white bg-nuclear-600 rounded-lg hover:bg-nuclear-500 transition">
                Calculate
              </button>
            </div>
          </form>
        </div>
      </section>

      <!-- Calculator 5: Optimum Tails Assay -->
      <section id="mode5" class="calc-section hidden">
        <div class="bg-slate-800/50 rounded-xl border border-slate-700/50 p-6">
          <div class="mb-6">
            <h3 class="text-lg font-semibold text-white mb-1">Optimum Tails Assay</h3>
            <p class="text-slate-500 text-sm">Find the economically optimal tails assay based on feed and SWU prices.</p>
          </div>

          <form id="form5" class="space-y-6">
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
              <div>
                <label for="cf5" class="block text-xs font-medium text-slate-400 mb-1.5">Feed Price</label>
                <div class="relative">
                  <input id="cf5" type="number" step="any" placeholder="75"
                    class="w-full bg-slate-900 border border-slate-700 rounded-lg px-3 py-2.5 text-sm text-white placeholder-slate-600 focus:border-nuclear-500 focus:ring-1 focus:ring-nuclear-500 outline-none transition" />
                  <span class="absolute right-3 top-1/2 -translate-y-1/2 text-xs text-slate-500">$/kg</span>
                </div>
              </div>
              <div>
                <label for="cs5" class="block text-xs font-medium text-slate-400 mb-1.5">SWU Price</label>
                <div class="relative">
                  <input id="cs5" type="number" step="any" placeholder="100"
                    class="w-full bg-slate-900 border border-slate-700 rounded-lg px-3 py-2.5 text-sm text-white placeholder-slate-600 focus:border-nuclear-500 focus:ring-1 focus:ring-nuclear-500 outline-none transition" />
                  <span class="absolute right-3 top-1/2 -translate-y-1/2 text-xs text-slate-500">$/SWU</span>
                </div>
              </div>
              <div>
                <label for="xp5" class="block text-xs font-medium text-slate-400 mb-1.5">Product Assay</label>
                <div class="relative">
                  <input id="xp5" type="number" step="any" placeholder="5"
                    class="w-full bg-slate-900 border border-slate-700 rounded-lg px-3 py-2.5 text-sm text-white placeholder-slate-600 focus:border-nuclear-500 focus:ring-1 focus:ring-nuclear-500 outline-none transition" />
                  <span class="absolute right-3 top-1/2 -translate-y-1/2 text-xs text-slate-500">% U-235</span>
                </div>
              </div>
              <div>
                <label for="xf5" class="block text-xs font-medium text-slate-400 mb-1.5">Feed Assay</label>
                <div class="relative">
                  <input id="xf5" type="number" step="any" placeholder="0.711"
                    class="w-full bg-slate-900 border border-slate-700 rounded-lg px-3 py-2.5 text-sm text-white placeholder-slate-600 focus:border-nuclear-500 focus:ring-1 focus:ring-nuclear-500 outline-none transition" />
                  <span class="absolute right-3 top-1/2 -translate-y-1/2 text-xs text-slate-500">% U-235</span>
                </div>
              </div>
            </div>

            <div class="h-px bg-slate-700/50"></div>

            <div class="sm:w-1/2">
              <label for="xw5" class="block text-xs font-medium text-slate-400 mb-1.5">Optimum Tails Assay</label>
              <div class="relative">
                <input id="xw5" type="text" readonly
                  class="w-full bg-slate-950 border border-slate-700 rounded-lg px-3 py-2.5 text-sm text-nuclear-400 font-mono outline-none" />
                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-xs text-slate-500">% U-235</span>
              </div>
            </div>

            <div class="flex gap-3 pt-2">
              <button type="button" id="clear5"
                class="flex-1 py-2.5 px-4 text-sm font-medium text-slate-400 bg-slate-800 border border-slate-700 rounded-lg hover:bg-slate-700 hover:text-white transition">
                Clear
              </button>
              <button type="button" id="calc5"
                class="flex-1 py-2.5 px-4 text-sm font-medium text-white bg-nuclear-600 rounded-lg hover:bg-nuclear-500 transition">
                Calculate
              </button>
            </div>
          </form>
        </div>
      </section>

    </div>
  </main>

  <!-- Footer -->
  <footer class="fixed bottom-0 left-0 right-0 py-3 text-center text-xs text-slate-600 bg-slate-900/95 backdrop-blur border-t border-slate-800">
    <span id="current-year"></span> bennyhartnett.com
  </footer>

  <!-- Calculator logic -->
  <script>
    (function () {
      const EPS = 1e-9;
      const byId = (id) => document.getElementById(id);

      // Tab navigation
      document.querySelectorAll('#calcTabs button').forEach(btn => {
        btn.addEventListener('click', () => {
          document.querySelectorAll('#calcTabs button').forEach(b => {
            b.classList.remove('tab-active');
            b.classList.add('text-slate-500');
          });
          btn.classList.add('tab-active');
          btn.classList.remove('text-slate-500');

          document.querySelectorAll('.calc-section').forEach(s => s.classList.add('hidden'));
          document.getElementById(btn.dataset.target).classList.remove('hidden');
        });
      });

      function showError(message) {
        Swal.fire({
          icon: "error",
          title: "Invalid input",
          text: message,
          background: '#1e293b',
          color: '#f1f5f9',
          confirmButtonColor: '#22c55e'
        });
      }

      function parseAssay(id) {
        const raw = byId(id).value.trim();
        const value = parseFloat(raw);
        if (!isFinite(value)) {
          throw new Error("Assay must be a number.");
        }
        if (value <= 0 || value >= 100) {
          throw new Error("Assay must be between 0 and 100 (exclusive).");
        }
        return value / 100;
      }

      function parseMass(id) {
        const raw = byId(id).value.trim();
        const value = parseFloat(raw);
        if (!isFinite(value) || value <= 0) {
          throw new Error("Mass values must be positive numbers.");
        }
        return value;
      }

      function parsePositiveNumber(id) {
        const raw = byId(id).value.trim();
        const value = parseFloat(raw);
        if (!isFinite(value) || value <= 0) {
          throw new Error("Values must be positive numbers.");
        }
        return value;
      }

      function valueFunction(x) {
        const xx = Math.min(Math.max(x, EPS), 1 - EPS);
        return (1 - 2 * xx) * Math.log((1 - xx) / xx);
      }

      function checkOrdering(xp, xf, xw) {
        if (!(xp > xf && xf > xw)) {
          throw new Error("Assays must satisfy: product > feed > tails.");
        }
      }

      function massBalance(P, xp, xf, xw) {
        checkOrdering(xp, xf, xw);
        const F = ((xp - xw) / (xf - xw)) * P;
        const W = F - P;
        if (F <= 0 || W <= 0) {
          throw new Error("Computed masses must be positive.");
        }
        return { F, W };
      }

      function swuFor(P, xp, xf, xw) {
        const { F, W } = massBalance(P, xp, xf, xw);
        const swu =
          P * valueFunction(xp) + W * valueFunction(xw) - F * valueFunction(xf);
        if (swu <= 0) {
          throw new Error("Computed SWU must be positive.");
        }
        return { F, W, swu };
      }

      function computeFeedSwuForOneKg(xp, xw, xf) {
        return swuFor(1, xp, xf, xw);
      }

      function computeFeedSwu(xp, xw, xf, P) {
        return swuFor(P, xp, xf, xw);
      }

      function computeEupSwu(xp, xw, xf, F) {
        checkOrdering(xp, xf, xw);
        const P = ((xf - xw) / (xp - xw)) * F;
        if (P <= 0) {
          throw new Error("Computed product mass must be positive.");
        }
        const W = F - P;
        const swu =
          P * valueFunction(xp) + W * valueFunction(xw) - F * valueFunction(xf);
        if (swu <= 0) {
          throw new Error("Computed SWU must be positive.");
        }
        return { P, W, swu };
      }

      function computeFeedEupFromSwu(xp, xw, xf, S) {
        checkOrdering(xp, xf, xw);
        if (S <= 0) throw new Error("SWU must be positive.");

        let Plo = EPS;
        let Phi = 1;

        while (true) {
          const { swu } = swuFor(Phi, xp, xf, xw);
          if (swu > S) break;
          Phi *= 2;
          if (Phi > 1e7) {
            throw new Error("SWU too large or parameters unrealistic.");
          }
        }

        for (let i = 0; i < 80; i++) {
          const Pmid = 0.5 * (Plo + Phi);
          const { swu } = swuFor(Pmid, xp, xf, xw);
          if (Math.abs(swu - S) / S < 1e-6) {
            Plo = Phi = Pmid;
            break;
          }
          if (swu > S) {
            Phi = Pmid;
          } else {
            Plo = Pmid;
          }
        }

        const P = 0.5 * (Plo + Phi);
        const { F } = massBalance(P, xp, xf, xw);
        return { P, F };
      }

      function findOptimumTails(xp, xf, cf, cs) {
        checkOrdering(xp, xf, xf / 2);

        const a = Math.max(EPS, xf * 0.01);
        const b = Math.max(a + EPS, xf - EPS);

        function costPerKg(xw) {
          const { F, W, swu } = swuFor(1, xp, xf, xw);
          return cf * F + cs * swu;
        }

        let left = a;
        let right = b;
        const phi = (1 + Math.sqrt(5)) / 2;
        let x1 = right - (right - left) / phi;
        let x2 = left + (right - left) / phi;
        let f1 = costPerKg(x1);
        let f2 = costPerKg(x2);

        for (let i = 0; i < 80; i++) {
          if (f1 > f2) {
            left = x1;
            x1 = x2;
            f1 = f2;
            x2 = left + (right - left) / phi;
            f2 = costPerKg(x2);
          } else {
            right = x2;
            x2 = x1;
            f2 = f1;
            x1 = right - (right - left) / phi;
            f1 = costPerKg(x1);
          }
        }

        const xwOpt = 0.5 * (left + right);
        const { F, W, swu } = swuFor(1, xp, xf, xwOpt);
        const cost = costPerKg(xwOpt);
        return { xw: xwOpt, F_per_P: F, swu_per_P: swu, cost_per_P: cost };
      }

      function resetForm(formId) {
        const form = byId(formId);
        if (!form) return;
        form.reset();
        form.querySelectorAll("input").forEach((input) => {
          if (input.hasAttribute("readonly")) {
            input.value = "";
          }
        });
      }

      function setupHandlers() {
        // Mode 1
        byId("calc1").addEventListener("click", () => {
          try {
            const xp = parseAssay("xp1");
            const xw = parseAssay("xw1");
            const xf = parseAssay("xf1");
            const res = computeFeedSwuForOneKg(xp, xw, xf);
            byId("feed1").value = res.F.toFixed(6);
            byId("swu1").value = res.swu.toFixed(3);
          } catch (err) {
            showError(err.message);
          }
        });
        byId("clear1").addEventListener("click", () => resetForm("form1"));

        // Mode 2
        byId("calc2").addEventListener("click", () => {
          try {
            const P = parseMass("p2");
            const xp = parseAssay("xp2");
            const xw = parseAssay("xw2");
            const xf = parseAssay("xf2");
            const res = computeFeedSwu(xp, xw, xf, P);
            byId("feed2").value = res.F.toFixed(6);
            byId("swu2").value = res.swu.toFixed(3);
          } catch (err) {
            showError(err.message);
          }
        });
        byId("clear2").addEventListener("click", () => resetForm("form2"));

        // Mode 3
        byId("calc3").addEventListener("click", () => {
          try {
            const F = parseMass("F3");
            const xp = parseAssay("xp3");
            const xw = parseAssay("xw3");
            const xf = parseAssay("xf3");
            const res = computeEupSwu(xp, xw, xf, F);
            byId("P3").value = res.P.toFixed(6);
            byId("swu3").value = res.swu.toFixed(3);
          } catch (err) {
            showError(err.message);
          }
        });
        byId("clear3").addEventListener("click", () => resetForm("form3"));

        // Mode 4
        byId("calc4").addEventListener("click", () => {
          try {
            const S = parsePositiveNumber("S4");
            const xp = parseAssay("xp4");
            const xw = parseAssay("xw4");
            const xf = parseAssay("xf4");
            const res = computeFeedEupFromSwu(xp, xw, xf, S);
            byId("P4").value = res.P.toFixed(6);
            byId("feed4").value = res.F.toFixed(6);
          } catch (err) {
            showError(err.message);
          }
        });
        byId("clear4").addEventListener("click", () => resetForm("form4"));

        // Mode 5
        byId("calc5").addEventListener("click", () => {
          try {
            const cf = parsePositiveNumber("cf5");
            const cs = parsePositiveNumber("cs5");
            const xp = parseAssay("xp5");
            const xf = parseAssay("xf5");
            const res = findOptimumTails(xp, xf, cf, cs);
            byId("xw5").value = (res.xw * 100).toFixed(3);
          } catch (err) {
            showError(err.message);
          }
        });
        byId("clear5").addEventListener("click", () => resetForm("form5"));

        const yearEl = document.getElementById("current-year");
        if (yearEl) yearEl.textContent = new Date().getFullYear();
      }

      if (document.readyState === "loading") {
        document.addEventListener("DOMContentLoaded", setupHandlers);
      } else {
        setupHandlers();
      }
    })();
  </script>
</body>
</html>
